<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>DoÄŸruel Kuyumculuk HÄ±zlÄ± Ä°ÅŸlem Paneli</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #111;
            margin: 0;
            padding: 0;
            color: #f1f1f1;
        }
        .header {
            background-color: #1e1e1e;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
        }
        .header h1 {
            color: gold;
            font-size: 22px;
        }
        .container {
            display: flex;
            padding: 20px;
        }
        .menu {
            flex: 1;
            background-color: #1c1c1c;
            padding: 20px;
            border-radius: 10px;
            margin-right: 20px;
        }
        .menu h3 {
            color: gold;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
        }
        .menu button {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background-color: #222;
            color: gold;
            border: none;
            border-radius: 5px;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .menu button:hover {
            background-color: #333;
        }
        .panel {
            flex: 2;
            background-color: #1c1c1c;
            padding: 20px;
            border-radius: 10px;
        }
        .panel input[type="number"] {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 5px;
            border: none;
            background-color: #2b2b2b;
            color: #fff;
        }
        .panel .toggle {
            display: flex;
            margin: 10px 0;
        }
        .toggle button {
            flex: 1;
            padding: 12px;
            background-color: #2b2b2b;
            color: #ccc;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            margin-right: 10px;
        }
        .toggle button.active {
            background-color: gold;
            color: #111;
            font-weight: bold;
        }
        .calc-output {
            font-size: 20px;
            color: #f66;
            margin-top: 10px;
        }
        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        .keypad button {
            padding: 20px;
            font-size: 20px;
            background-color: #222;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .keypad button:hover {
            background-color: #333;
        }
        #submitBtn {
            width: 100%;
            margin-top: 20px;
            padding: 15px;
            background-color: red;
            color: white;
            font-weight: bold;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        #summaryBox {
            margin-top: 30px;
            background: #222;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            color: gold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸ’Ž DoÄŸruel Kuyumculuk HÄ±zlÄ± Ä°ÅŸlem Paneli</h1>
    </div>
    <div class="container">
        <div class="menu">
            <h3>DÃ¶viz ÃœrÃ¼nleri</h3>
            <button data-urun="Has AltÄ±n">Has AltÄ±n</button>
            <button data-urun="Dolar">Dolar</button>
            <button data-urun="Euro">Euro</button>
            <button data-urun="Sterlin">Sterlin</button>
            <button data-urun="Gram AltÄ±n">Gram AltÄ±n</button>
            <button data-urun="Ã‡eyrek">Ã‡eyrek</button>
            <button data-urun="YarÄ±m">YarÄ±m</button>
            <button data-urun="Cumhuriyet">Cumhuriyet</button>
            <button data-urun="Ata Lira">Ata Lira</button>                        
        </div>
        <div class="panel">
            <div class="toggle">
                <button id="satisBtn" class="active" onclick="setMode('satis')">SATIÅž</button>
                <button id="alisBtn" onclick="setMode('alis')">ALIÅž</button>
            </div>
            <div id="selectedProduct">ÃœrÃ¼n: -</div>
            <input type="number" id="adet" placeholder="Adet girin">
            <div class="calc-output" id="calcResult">Tutar: 0 TL</div>
            <div class="keypad">
                <button onclick="appendNumber(1)">1</button>
                <button onclick="appendNumber(2)">2</button>
                <button onclick="appendNumber(3)">3</button>
                <button onclick="appendNumber(4)">4</button>
                <button onclick="appendNumber(5)">5</button>
                <button onclick="appendNumber(6)">6</button>
                <button onclick="appendNumber(7)">7</button>
                <button onclick="appendNumber(8)">8</button>
                <button onclick="appendNumber(9)">9</button>
                <button onclick="clearInput()">SÄ°L</button>
                <button onclick="appendNumber(0)">0</button>
                <button onclick="calculate()">=</button>
            </div>
            <button id="submitBtn" onclick="submitTransaction()">Ä°ÅžLEMÄ° TAMAMLA</button>
            <div class="output" id="transactionHistory" style="margin-top: 30px; border-top: 1px solid #333; padding-top: 20px;"></div>
            <div id="summaryBox">Toplam KÃ¢r: 0 TL</div>
        </div>
    </div>
    <!-- TEMÄ°ZLENMÄ°Åž VE GÃœNCELLENMÄ°Åž KOD (TRUNCgil API ENTEGRASYONU) -->
    <script>
        let currentMode = 'satis';
        let selected = { name: '', price: 0 };
        const transactions = [];
        let totalProfit = 0;
        const prices = {};
    
        async function fetchPrices() {
            try {
                const res = await fetch("https://api.allorigins.win/raw?url=https://finans.truncgil.com/v4/today.json");
                const data = await res.json();
    
                prices["Dolar"] = parseFloat(data["USD"]["Selling"]);
                prices["Euro"] = parseFloat(data["EUR"]["Selling"]);
                prices["Sterlin"] = parseFloat(data["GBP"]["Selling"]);
    
                prices["Has AltÄ±n"] = parseFloat(data["HAS"]?.Selling || 0);
                prices["Ã‡eyrek"] = parseFloat(data["CEY"]?.Selling || prices["Has AltÄ±n"] * 1.75);
                prices["YarÄ±m"] = parseFloat(data["YAR"]?.Selling || prices["Has AltÄ±n"] * 3.5);
                prices["Ata Lira"] = parseFloat(data["ATA"]?.Selling || prices["Has AltÄ±n"] * 7.2);
                prices["Gram AltÄ±n"] = parseFloat(data["GRA"]?.Selling || 0);
                prices["Cumhuriyet"] = parseFloat(data["CUM"]?.Selling || 0);
    
                updateMenuButtons();
            } catch (e) {
                console.error("Fiyatlar Ã§ekilemedi:", e);
                alert("Veriler alÄ±namadÄ±. Ä°nternet baÄŸlantÄ±nÄ±zÄ± kontrol edin veya tekrar deneyin.");
            }
        }
    
        function updateMenuButtons() {
            const urunler = ['Has AltÄ±n', 'Dolar', 'Euro', 'Sterlin', 'Ã‡eyrek', 'YarÄ±m', 'Ata Lira', 'Gram AltÄ±n', 'Cumhuriyet'];
            urunler.forEach(urun => {
                const btn = document.querySelector(`button[data-urun='${urun}']`);
                if (btn) {
                    btn.innerText = `${urun} â€“ ${prices[urun]?.toFixed(2) || '?'} TL`;
                }
            });
        }
    
        function setMode(mode) {
            currentMode = mode;
            document.getElementById('satisBtn').classList.remove('active');
            document.getElementById('alisBtn').classList.remove('active');
            document.getElementById(mode + 'Btn').classList.add('active');
            calculate();
        }
    
        function selectProduct(name, price) {
            selected.name = name;
            selected.price = price;
            document.getElementById('selectedProduct').innerText = `ÃœrÃ¼n: ${name}`;
            calculate();
        }
    
        function appendNumber(num) {
            const adetInput = document.getElementById("adet");
            adetInput.value += num;
            calculate();
        }
    
        function clearInput() {
            document.getElementById("adet").value = '';
            document.getElementById("calcResult").innerText = 'Tutar: 0 TL';
        }
    
        function calculate() {
            const adet = parseFloat(document.getElementById("adet").value);
            if (!isNaN(adet) && selected.price > 0) {
                const tutar = adet * selected.price;
                document.getElementById("calcResult").innerText = `Tutar: ${tutar.toFixed(2)} TL`;
            }
        }
    
        function submitTransaction() {
            const adet = parseFloat(document.getElementById("adet").value);
            if (!selected.name || isNaN(adet)) {
                alert("LÃ¼tfen Ã¼rÃ¼n seÃ§in ve adet girin.");
                return;
            }
            const tutar = adet * selected.price;
            const date = new Date().toLocaleString();
            const isSatis = currentMode === 'satis';
            const kar = isSatis ? adet * (selected.price * 0.03) : 0;
    
            const data = {
                tarih: date,
                tur: currentMode.toUpperCase(),
                urun: selected.name,
                fiyat: selected.price,
                adet: adet,
                tutar: tutar.toFixed(2),
                kar: kar.toFixed(2)
            };
    
            transactions.push(data);
            if (isSatis) totalProfit += kar;
            renderTransactions();
            clearInput();
        }
    
        function renderTransactions() {
            const out = document.getElementById("transactionHistory");
            out.innerHTML = '<h3>ðŸ“‹ GÃ¼nlÃ¼k Ä°ÅŸlemler</h3>' +
                transactions.map(t =>
                    `<div style='margin-bottom:10px;'>
                        <strong>${t.tur}</strong> â€“ ${t.urun} â€“ ${t.adet} adet Ã— ${t.fiyat} TL = <strong>${t.tutar} TL</strong>
                        ${t.kar > 0 ? `(<span style='color:lime'>+${t.kar} TL kÃ¢r</span>)` : ''}<br><small>${t.tarih}</small>
                    </div>`
                ).join('');
            document.getElementById("summaryBox").innerText = `Toplam KÃ¢r: ${totalProfit.toFixed(2)} TL`;
        }
    
        window.onload = () => {
            fetchPrices();
            setInterval(fetchPrices, 60000);
    
            document.querySelectorAll("button[data-urun]").forEach(btn => {
                const urun = btn.getAttribute("data-urun");
                btn.onclick = () => {
                    const fiyat = prices[urun] || 0;
                    if (!fiyat) {
                        alert(`${urun} fiyatÄ± henÃ¼z yÃ¼klenmedi. LÃ¼tfen birkaÃ§ saniye sonra tekrar deneyin.`);
                        return;
                    }
                    selectProduct(urun, fiyat);
                };
            });
        };
    </script>
</body>
</html>